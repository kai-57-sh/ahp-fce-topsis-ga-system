# Ci Score (贴近度系数) 详细计算说明

## 概述

Ci Score（贴近度系数）是AHP-FCE-TOPSIS-GA评估系统的最终得分，用于衡量无人作战体系配置方案的综合效能。Ci值的范围为[0, 1]，值越接近1表示方案越优。

## 计算流程概览

Ci Score的计算采用AHP-FCE-TOPSIS混合算法，包含以下主要步骤：

```
原始方案数据 → AHP权重计算 → FCE模糊评价 → TOPSIS排序 → Ci Score
```

## 详细计算步骤

### 第1步：数据预处理和指标值生成

#### 1.1 方案配置数据解析
从方案配置文件（如 `simple_template.yaml`）中提取关键参数：

```yaml
# 平台编成数据
platform_inventory:
  USV_Unmanned_Surface_Vessel: count: 8
  UUV_Unmanned_Underwater_Vessel: count: 4

# 任务分配数据
task_assignments:
  surveillance_patrol: assigned_platforms: 4
  anti_submarine_warfare: assigned_platforms: 3
```

#### 1.2 定量指标值计算
根据平台数量和任务分配计算各二级指标的数值：

```
C1_1 (侦察探测能力) = 侦察平台数 / 总平台数 = 3 / 12 = 0.25
C1_2 (信息融合能力) = 信息融合平台数 / 总平台数 = 0 / 12 = 0.00
C1_3 (态势理解能力) = 态势理解平台数 / 总平台数 = 0 / 12 = 0.00
...
```

### 第2步：AHP权重计算

#### 2.1 一级指标权重
从专家判断矩阵计算一级指标权重：

```
一级指标判断矩阵 (5×5):
    C1   C2   C3   C4   C5
C1  1.0  1.25 1.0  1.67 1.67
C2  0.8  1.0  0.8  1.33 1.33
C3  1.0  1.25 1.0  1.67 1.67
C4  0.6  0.75 0.6  1.0  1.0
C5  0.6  0.75 0.6  1.0  1.0
```

通过特征向量法计算得到权重：
```
W_primary = [0.25, 0.20, 0.25, 0.15, 0.15]
```

#### 2.2 二级指标权重
每个一级指标下的二级指标权重均匀分配：

```
C1下二级指标权重: W_C1 = [0.32, 0.36, 0.32]
C2下二级指标权重: W_C2 = [0.35, 0.35, 0.30]
...
```

#### 2.3 全局权重计算
二级指标的全局权重 = 一级指标权重 × 二级指标相对权重：

```
C1_1全局权重 = 0.25 × 0.32 = 0.08
C1_2全局权重 = 0.25 × 0.36 = 0.09
C1_3全局权重 = 0.25 × 0.32 = 0.08
...
```

最终全局权重向量（15个指标）：
```
W_global = [0.08, 0.09, 0.08, 0.07, 0.07, 0.06, 0.08, 0.09, 0.08,
           0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
```

### 第3步：FCE模糊综合评价

#### 3.1 专家评估数据处理
从方案配置文件中提取专家评估：

```yaml
expert_assessments:
  C1_1_Reconnaissance_Detection:
    linguistic_term: "良"
    confidence: 0.80
```

#### 3.2 模糊评价集映射
将语言变量转换为数值：

```
模糊评价集映射:
差 → 0.25
中 → 0.50
良 → 0.75
优 → 1.00
```

#### 3.3 模糊综合评价计算
对每个二级指标进行模糊评价：

```
C1_1模糊评分 = 0.75 (良) × 0.80 (置信度) = 0.60
C1_2模糊评分 = 0.50 (中) × 0.75 (置信度) = 0.375
...
```

### 第4步：指标值融合

#### 4.1 构建决策矩阵
将定量指标和模糊评价结果融合：

```
决策矩阵 D (m×n，m为方案数，n为指标数):
方案1: [0.25, 0.375, 0.49, 0.64, 0.525, 0.64, 0.765, 0.525, 0.525, 0.68, 0.68, 0.60, 0.68, 0.765, 0.68]
方案2: [0.33, 0.375, 0.42, 0.64, 0.525, 0.64, 0.765, 0.525, 0.525, 0.68, 0.68, 0.60, 0.68, 0.765, 0.68]
```

### 第5步：TOPSIS计算

#### 5.1 向量归一化
对决策矩阵进行向量归一化：

```
归一化公式: r_ij = x_ij / √(∑(x_ij²))

归一化矩阵 R:
方案1: [0.535, 0.661, 0.664, 0.664, 0.664, 0.665, 0.665, 0.661, 0.664, 0.664, 0.664, 0.665, 0.664, 0.665, 0.664]
方案2: [0.707, 0.661, 0.571, 0.664, 0.664, 0.665, 0.665, 0.661, 0.664, 0.664, 0.664, 0.665, 0.664, 0.665, 0.664]
```

#### 5.2 加权归一化矩阵
将归一化矩阵与权重相乘：

```
加权归一化矩阵 V = R × W_global

方案1: [0.043, 0.059, 0.053, 0.047, 0.047, 0.040, 0.053, 0.059, 0.053, 0.033, 0.033, 0.033, 0.033, 0.038, 0.033]
方案2: [0.057, 0.059, 0.046, 0.047, 0.047, 0.040, 0.053, 0.059, 0.053, 0.033, 0.033, 0.033, 0.033, 0.038, 0.033]
```

#### 5.3 确定理想解

**正理想解 (PIS)**：每个指标的最大值
```
PIS = [0.057, 0.059, 0.053, 0.047, 0.047, 0.040, 0.053, 0.059, 0.053, 0.033, 0.033, 0.033, 0.033, 0.038, 0.033]
```

**负理想解 (NIS)**：每个指标的最小值
```
NIS = [0.043, 0.059, 0.046, 0.047, 0.047, 0.040, 0.053, 0.059, 0.053, 0.033, 0.033, 0.033, 0.033, 0.038, 0.033]
```

#### 5.4 计算距离

**到正理想解的距离 (D+)**：
```
D+_方案1 = √[∑(V1j - PISj)²] = √[(0.043-0.057)² + (0.059-0.059)² + ... + (0.033-0.033)²] = 0.014
D+_方案2 = √[∑(V2j - PISj)²] = √[(0.057-0.057)² + (0.059-0.059)² + ... + (0.033-0.033)²] = 0.000
```

**到负理想解的距离 (D-)**：
```
D-_方案1 = √[∑(V1j - NISj)²] = √[(0.043-0.043)² + (0.059-0.059)² + ... + (0.033-0.033)²] = 0.000
D-_方案2 = √[∑(V2j - NISj)²] = √[(0.057-0.043)² + (0.059-0.059)² + ... + (0.033-0.033)²] = 0.014
```

### 第6步：Ci Score计算

#### 6.1 贴近度系数公式
```
Ci = D- / (D+ + D-)
```

#### 6.2 具体计算

**方案1**：
```
Ci_方案1 = 0.000 / (0.014 + 0.000) = 0.000
```

**方案2**：
```
Ci_方案2 = 0.014 / (0.000 + 0.014) = 1.000
```

### 第7步：结果解释

#### 7.1 Ci Score含义
- **Ci = 1.0**：方案完全贴近正理想解，是最优方案
- **Ci = 0.0**：方案完全贴近负理想解，是最差方案
- **0 < Ci < 1**：方案在正负理想解之间的相对位置

#### 7.2 排序规则
Ci值越大，方案排序越靠前。在本例中：
```
排序结果：
1. 方案2: Ci = 1.000 (最优)
2. 方案1: Ci = 0.000 (最差)
```

## 关键技术要点

### 1. AHP一致性检验
```
一致性比率 CR = CI / RI
其中：CI = (λ_max - n) / (n - 1)
RI 为随机一致性指标

要求：CR < 0.1 (通过一致性检验)
```

### 2. 模糊综合评价
```
模糊评分 = ∑(隶属度 × 对应数值)
其中隶属度通过专家评估的语言变量确定
```

### 3. TOPSIS归一化
```
向量归一化：r_ij = x_ij / √(∑x_ik²)
确保消除量纲影响，便于比较
```

### 4. 权重分配验证
```
权重总和检验：∑W_global = 1.0
一级指标权重和：∑W_primary = 1.0
各二级指标权重和：∑W_secondary = 1.0
```

## 实际应用中的注意事项

1. **数据质量**：确保专家评估的客观性和一致性
2. **权重合理性**：AHP判断矩阵需通过一致性检验
3. **指标类型**：正确区分效益型指标（越大越好）和成本型指标（越小越好）
4. **数值范围**：所有指标值应非负，避免归一化错误
5. **计算精度**：注意浮点数精度问题，避免计算误差

## 总结

Ci Score是综合考虑了AHP权重、FCE模糊评价和TOPSIS排序的多指标决策结果，能够全面反映无人作战体系配置方案的综合效能。通过这种混合算法，既考虑了专家经验的重要性（AHP），又处理了定性指标的模糊性（FCE），最终实现了多方案的客观排序（TOPSIS）。